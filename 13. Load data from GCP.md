# Loading Data from GCP to Snowflake

## Creating Integration Object

To load data from Google Cloud Platform (GCP) to Snowflake, you first need to create an integration object in Snowflake. This integration object allows Snowflake to access your GCP storage.

```sql
CREATE STORAGE INTEGRATION my_gcp_integration
TYPE = EXTERNAL_STAGE
STORAGE_PROVIDER = GCS
ENABLED = TRUE
STORAGE_ALLOWED_LOCATIONS = ('gs://my_bucket/');
```

## Creating File Format Object and Stage

Next, create a file format object to define the format of the data files you will be loading. Then, create a stage to specify the location of the data in GCP.

```sql
CREATE OR REPLACE FILE FORMAT my_csv_format
TYPE = CSV
FIELD_OPTIONALLY_ENCLOSED_BY = '"'
SKIP_HEADER = 1;

CREATE OR REPLACE STAGE my_gcp_stage
URL = 'gs://my_bucket/data/'
STORAGE_INTEGRATION = my_gcp_integration
FILE_FORMAT = my_csv_format;
```

## Query and Load Data

Once the stage is set up, you can query and load data from GCP into Snowflake tables.

```sql
COPY INTO my_table
FROM @my_gcp_stage
FILE_FORMAT = (FORMAT_NAME = 'my_csv_format');
```

## Unload Data

To unload data from Snowflake back to GCP, use the following command:

```sql
COPY INTO @my_gcp_stage/unload/
FROM my_table
FILE_FORMAT = (FORMAT_NAME = 'my_csv_format');
```

This will export the data from the Snowflake table to the specified GCP bucket in the defined format.