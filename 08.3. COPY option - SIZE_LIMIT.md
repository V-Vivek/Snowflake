# SIZE_LIMIT Option in Snowflake

The `SIZE_LIMIT` option in Snowflake is used to specify the maximum size of data that can be loaded into a table in a single `COPY` statement. This option is particularly useful when dealing with large datasets to prevent overloading the system.

## Behavior of SIZE_LIMIT

When the `SIZE_LIMIT` is set, the `COPY` statement will load the first file regardless of its size. From the second file onwards, none of the files will be loaded partially. Each file will either be loaded completely or skipped entirely if loading it would exceed the specified size limit.

### Example with Multiple Files

Consider a scenario where we have four files to load:

1. `file1.csv` - 60 MB
2. `file2.csv` - 20 MB
3. `file3.csv` - 20 MB
4. `file4.csv` - 20 MB

## Example #1

```sql
COPY INTO my_table
FROM @my_stage
FILES = ('file1.csv', 'file2.csv', 'file3.csv')
FILE_FORMAT = (TYPE = 'CSV')
SIZE_LIMIT = 50000000; -- 50 MB
```
- Here `file1.csv` will be loaaded completely although it's size is more than the SIZE_LIMIT because it is the 1st file. 
- But the `file2.csv`, `file3.csv` and `file4.csv` will be skipped as the total has exceeded the SIZE_LIMIT.

## Example #2

```sql
COPY INTO my_table
FROM @my_stage
FILES = ('file1.csv', 'file2.csv', 'file3.csv')
FILE_FORMAT = (TYPE = 'CSV')
SIZE_LIMIT = 90000000; -- 90 MB
```
- Here `file1.csv` will be loaded as it's the first file.
- Until now we have loaded 60 MB which is less than SIZE_LIMIT hence `file2.csv` will be loaded.
- Until now we have loaded 80 MB which is less than SIZE_LIMIT hence `file3.csv` will be loaded.
- Until now we have loaded 100 MB which is more than SIZE_LIMIT hence `file4.csv` will not be loaded.

This ensures that the data loading process is efficient and does not overload the system, while also preventing partial data loads which could lead to inconsistencies.
