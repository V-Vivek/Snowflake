# Loading Data in Snowflake

## Bulk Loading

Bulk loading in Snowflake involves loading large volumes of data in a single operation. This method is efficient for initial data loads or periodic batch updates. The key steps for bulk loading are:

1. **Stage the Data**: Upload the data files to a Snowflake stage (internal or external).
2. **Copy into Table**: Use the `COPY INTO` command to load the data from the stage into the target table.

### Example - Using Internal Stage
```sql
-- Create a stage
CREATE OR REPLACE STAGE my_stage;

-- Upload data to the stage
PUT file://path/to/data/file.csv @my_stage;

-- Load data into the table
COPY INTO my_table
FROM @my_stage/file.csv
FILE_FORMAT = (TYPE = 'CSV');
```

### Example - Using External Stage
```sql
-- Create an external stage pointing to an S3 bucket
CREATE OR REPLACE STAGE my_external_stage
URL = 's3://my-bucket/path/'
CREDENTIALS = (AWS_KEY_ID = 'your_key_id' AWS_SECRET_KEY = 'your_secret_key');

-- Load data from the external stage into a table
COPY INTO my_table
FROM @my_external_stage
FILE_FORMAT = (TYPE = 'CSV');

-- Load data from a specific file in the external stage into a table
COPY INTO my_table
FROM @my_external_stage/specific_file.csv
FILE_FORMAT = (TYPE = 'CSV');

-- Load data from multiple files using a wildcard in the external stage into a table
COPY INTO my_table
FROM @my_external_stage/prefix_*.csv
FILE_FORMAT = (TYPE = 'CSV');

-- Load data from multiple specific files in the external stage into a table
COPY INTO my_table
FROM @my_external_stage
FILES = ('file1.csv', 'file2.csv')
FILE_FORMAT = (TYPE = 'CSV');

-- Load data from files matching a pattern(regex_pattern) in the external stage into a table
COPY INTO my_table
FROM @my_external_stage
PATTERN = '.*prefix_.*\.csv'
FILE_FORMAT = (TYPE = 'CSV');
```

## Continuous Loading

Continuous loading in Snowflake is designed for real-time or near-real-time data ingestion. This method uses Snowpipe, a Snowflake service that automates data loading as soon as new data files are available in a stage.

### Key Features
- **Automated**: Snowpipe automatically detects and loads new data files.
- **Scalable**: Handles varying data volumes efficiently.
- **Low Latency**: Provides near real-time data availability.

### Example
1. **Create a Pipe**: Define a Snowpipe to specify the data source and target table.
2. **Stage the Data**: Upload data files to the stage.
3. **Trigger Snowpipe**: Snowpipe automatically loads the data.

```sql
-- Create a stage
CREATE OR REPLACE STAGE my_stage;

-- Create a pipe
CREATE OR REPLACE PIPE my_pipe AS
COPY INTO my_table
FROM @my_stage
FILE_FORMAT = (TYPE = 'CSV');

-- Upload data to the stage
PUT file://path/to/data/file.csv @my_stage;

-- Snowpipe automatically loads the data
```

By using these methods, Snowflake ensures efficient and scalable data loading to meet various data ingestion needs.