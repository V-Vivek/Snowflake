# Update or Delete Records in Snowflake Iceberg Table

## Copy on Write Method

### Overview
The Copy on Write (CoW) method involves creating a new version of the data file with the updates or deletions applied. The old version of the file remains unchanged until the new version is fully written and validated.

### Advantages
- **Data Integrity**: Ensures that the data is always in a consistent state, as the old version is only replaced once the new version is fully written.
- **Simplicity**: Easier to implement and understand since it deals with whole files rather than individual records.

### Drawbacks
- **Performance**: Can be slower for large datasets as it requires rewriting entire files even for small updates or deletions.
- **Storage**: Requires additional storage space temporarily to hold both the old and new versions of the data files.

## Merge on Read Method

### Overview
The Merge on Read (MoR) method involves writing only the changes (updates or deletions) to a separate delta file. When reading the data, the base file and the delta file are merged to present the latest view of the data.

### Advantages
- **Performance**: More efficient for large datasets as it only writes the changes rather than the entire file.
- **Storage**: Requires less additional storage space since only the changes are stored in the delta file.

### Drawbacks
- **Complexity**: More complex to implement and manage as it requires merging the base and delta files during read operations.
- **Read Performance**: Can be slower for read operations as it needs to merge the base and delta files to present the latest data.


## Note
- As of now Snowflake only supports `Copy on Write` method