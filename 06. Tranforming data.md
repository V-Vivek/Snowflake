# Data Transformation During Loading with COPY Command

Transform data while loading into Snowflake using the `COPY` command. Below are common scenarios:

## 1. Select Specific Columns from CSV

Specify the columns to load from the CSV file:

```sql
CREATE OR REPLACE TABLE my_table (
    column1 STRING,
    column2 STRING
);

COPY INTO my_table (column1, column2)
FROM (select s.$1, s.$2 from @my_stage/my_file.csv s)
FILE_FORMAT = (TYPE = 'CSV');
```

## 2. Create New Column with CASE WHEN

Create a new column based on conditions using `CASE WHEN`:

```sql
CREATE OR REPLACE TABLE my_table (
    column1 STRING,
    new_column STRING
);

COPY INTO my_table (column1, new_column)
FROM (
    select s.$1, 
           case 
               when s.$2 = 'value1' then 'new_value1'
               else 'new_value2'
           end
    from @my_stage/my_file.csv s
)
FILE_FORMAT = (TYPE = 'CSV');
```

## 3. Trim Data with SUBSTRING

Trim data using the `SUBSTRING` function:

```sql
CREATE OR REPLACE TABLE my_table (
    column1 STRING,
    trimmed_column STRING
);

COPY INTO my_table (column1, trimmed_column)
FROM (
    select s.$1, 
           SUBSTRING(s.$2, 1, 10) AS trimmed_column
    from @my_stage/my_file.csv s
)
FILE_FORMAT = (TYPE = 'CSV');
```

## 4. Concatenate Columns

Concatenate two columns into one:

```sql
CREATE OR REPLACE TABLE my_table (
    column1 STRING,
    concatenated_column STRING
);

COPY INTO my_table (column1, concatenated_column)
FROM (
    select s.$1, 
           s.$2 || ' ' || s.$3
    from @my_stage/my_file.csv s
)
FILE_FORMAT = (TYPE = 'CSV');
```

## 5. Insert Data into Specific Columns

Insert data for specific columns, leaving others as `NULL`:

```sql
CREATE OR REPLACE TABLE my_table (
    column1 STRING,
    column2 STRING,
    column3 STRING
);

COPY INTO my_table (column1, column3)
FROM (select s.$1, s.$3 from @my_stage/my_file.csv s)
FILE_FORMAT = (TYPE = 'CSV');
```

## 6. Use AUTOINCREMENT for Default Values

Generate default values for a column using `AUTOINCREMENT`:

```sql
CREATE OR REPLACE TABLE my_table (
    id INT AUTOINCREMENT START 1 INCREMENT 1,
    column1 STRING,
    column2 STRING
);

COPY INTO my_table (column1, column2)
FROM (select s.$1, s.$2 from @my_stage/my_file.csv s)
FILE_FORMAT = (TYPE = 'CSV');
```