# COPY Option: ON_ERROR

The `ON_ERROR` option in the `COPY` command specifies how to handle errors encountered during data loading. Below are the different types of `ON_ERROR` options and their effects when loading data from two files into a single table.

## 1. ABORT_STATEMENT (Default)
When `ON_ERROR` is set to `ABORT_STATEMENT`, the entire `COPY` operation is aborted if any error is encountered in either of the files. No data is loaded into the table.

```sql
COPY INTO my_table
FROM @my_stage
FILES = ('file1.csv', 'file2.csv')
FILE_FORMAT = (TYPE = 'CSV')
ON_ERROR = 'ABORT_STATEMENT';
```

## 2. CONTINUE
When `ON_ERROR` is set to `CONTINUE`, the `COPY` operation continues loading data even if errors are encountered. The rows causing errors are skipped, and the rest of the data is loaded into the table.

```sql
COPY INTO my_table
FROM @my_stage
FILES = ('file1.csv', 'file2.csv')
FILE_FORMAT = (TYPE = 'CSV')
ON_ERROR = 'CONTINUE';
```

## 3. SKIP_FILE
When `ON_ERROR` is set to `SKIP_FILE`, the entire file is skipped if any error is encountered within that file. The other file will still be processed and loaded into the table.

```sql
COPY INTO my_table
FROM @my_stage
FILES = ('file1.csv', 'file2.csv')
FILE_FORMAT = (TYPE = 'CSV')
ON_ERROR = 'SKIP_FILE';
```

## 4. SKIP_FILE_number
When `ON_ERROR` is set to `SKIP_FILE_<number>`, the file is skipped if the number of errors encountered exceeds the specified number. For example, `SKIP_FILE_5` skips the file if more than 5 errors are found.

```sql
COPY INTO my_table
FROM @my_stage
FILES = ('file1.csv', 'file2.csv')
FILE_FORMAT = (TYPE = 'CSV')
ON_ERROR = 'SKIP_FILE_5';
```

## 5. SKIP_FILE%
When `ON_ERROR` is set to `SKIP_FILE<percent>`, the file is skipped if the percentage of errors encountered exceeds the specified percentage. For example, `SKIP_FILE10%` skips the file if more than 10% of the rows have errors.

```sql
COPY INTO my_table
FROM @my_stage
FILES = ('file1.csv', 'file2.csv')
FILE_FORMAT = (TYPE = 'CSV')
ON_ERROR = 'SKIP_FILE10%';
```

### Example Scenario
Assume we are loading data from two files, `file1.csv` and `file2.csv`, into a single table `my_table`.

- **ABORT_STATEMENT**: If `file1.csv` has an error, the entire `COPY` operation is aborted, and no data from either file is loaded.
- **CONTINUE**: If `file1.csv` has errors, those rows are skipped, and the rest of the data from both files is loaded.
- **SKIP_FILE**: If `file1.csv` has an error, `file1.csv` is skipped entirely, but `file2.csv` is still processed and loaded.
- **SKIP_FILE_5**: If `file1.csv` has more than 5 errors, `file1.csv` is skipped, but `file2.csv` is still processed and loaded.
- **SKIP_FILE10%**: If more than 10% of the rows in `file1.csv` have errors, `file1.csv` is skipped, but `file2.csv` is still processed and loaded.

Choose the appropriate `ON_ERROR` option based on your data quality requirements and error tolerance.